<!doctype html>
<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <title>Empathy Avatar M3</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <main class="dashboard">
      <div class="grid">
        <div class="card camera-card">
          <header>
            <span>摄像头</span>
            <span class="live-indicator"><span class="dot"></span>LIVE</span>
          </header>
          <div class="body camera-body">
            <img id="video" alt="camera stream" />
            <div class="status-pill stream-status" id="streamStatus" data-state="idle">
              等待连接摄像头…
            </div>
          </div>
        </div>

        <div class="card status-card">
          <header>状态与回复</header>
          <div class="body">
            <div class="row">
              <div>融合情绪：<strong id="emo">-</strong></div>
              <div class="tag">置信度 <span id="conf">-</span></div>
              <div><small>输出采样率：<span id="sr">-</span></small></div>
            </div>
            <div class="reply" id="reply">等待连接...</div>
            <div class="status" id="dialogStatus"></div>
            <div class="risk-badge" id="riskBadge"></div>
            <div class="status" id="netstat"></div>
          </div>
        </div>

        <div class="card panel-card">
          <header>数字人面板</header>
          <div class="body">
            <div class="row">
              <div>当前轮次：<strong id="turnId">-</strong></div>
              <div class="tag">触发 <span id="triggerList">-</span></div>
            </div>
            <div class="status">策略：<strong id="strategyLabel">-</strong> · 语气 <span id="styleLabel">-</span></div>
            <div class="status">Viseme FPS：<span id="visemeFps">-</span></div>
            <div class="viseme-bars empty" id="visemeBars">等待音频...</div>
            <audio id="player" controls autoplay></audio>
          </div>
        </div>

        <div class="card strategy-card">
          <header>策略来源</header>
          <div class="body">
            <div class="section-title">检索线索</div>
            <div class="clue-list" id="clueList"></div>
            <div class="section-title" style="margin-top:12px;">命中片段</div>
            <div class="sources-list" id="sourcesList"></div>
          </div>
        </div>

        <div class="card analysis-card">
          <header>多模态分析 <small id="fusionLabel" class="muted"></small></header>
          <div class="body">
            <div class="mode-list">
              <div class="mode-item">
                <div>
                  <strong>视觉 (FER)</strong>
                  <div class="mode-detail" id="visionStatus">等待...</div>
                </div>
              </div>
              <div class="mode-item">
                <div>
                  <strong>语音 (SER)</strong>
                  <div class="mode-detail" id="audioStatus">等待音频...</div>
                </div>
              </div>
              <div class="mode-item">
                <div>
                  <strong>文本</strong>
                  <div class="mode-detail" id="textStatusLine">尚未输入文本</div>
                </div>
              </div>
            </div>
            <div class="weights" id="fusionWeights">融合权重：-</div>
          </div>
        </div>

        <div class="card input-card">
          <header>输入与调节</header>
          <div class="body">
            <textarea id="userText" placeholder="在这里输入你想表达的话语，点击发送后将参与情绪融合..."></textarea>
            <div class="row" style="margin-top:8px;justify-content:flex-end">
              <button type="button" class="secondary" id="clearText">清空</button>
              <button type="button" id="sendText">发送文本</button>
            </div>
            <div class="status" id="textStatus"></div>
          </div>
        </div>

        <div class="card timeline-card">
          <header>对话时间轴</header>
          <div class="body">
            <div class="timeline" id="timelineList">
              <div class="timeline-empty">暂无对话记录</div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      Empathy Avatar M3 · 本地离线演示界面
    </footer>

    <script type="module" src="./app.js"></script>
  </body>
</html>
